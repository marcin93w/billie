webpackJsonp([1],{"05eA":function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.beginShareFlow=function(e,n){return new a.a(function(t,o){window.MessengerExtensions.beginShareFlow(function(e){t(e)},function(e,n){o(n)},e,n)})},n.getContext=function(e){return new a.a(function(n,t){window.MessengerExtensions.getContext(e,function(e){n(e)},function(e){t(e)})})},n.requestCloseBrowser=function(){window.MessengerExtensions.requestCloseBrowser()},n.askPermission=function(e){return new a.a(function(n,t){window.MessengerExtensions.askPermission(function(e){var o=e.isGranted;o?n():t(new Error("Permission not granted"))},function(e,n){t(new Error(n))},e)})},n.getGrantedPermissions=function(){return new a.a(function(e,n){window.MessengerExtensions.getGrantedPermissions(function(n){var t=n.permissions;e(t)},function(e){return n(new Error("permisions error"))})})};var o=t("//Fk"),a=t.n(o)},NHnr:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t("7+uW"),a={render:function(){var e=this.$createElement,n=this._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var r=t("VU/8")({name:"app"},a,!1,function(e){t("aTrT")},null,null).exports,i=t("/ocq"),s={homeUrl:"https://messenger-debt-bot.herokuapp.com/",fbAppId:"135139390498529",apiUrl:""},u={LENT:0,BORROWED:1,LENT_PAYOFF:2,BORROWED_PAYOFF:3},c=void 0,d=(c=t("05eA")).beginShareFlow,p=c.getContext,l=c.requestCloseBrowser,f=c.askPermission,m=c.getGrantedPermissions;function v(e){return"male"===e?"":"a"}function w(e,n,t,o,a){var r,i={attachment:{type:"template",payload:{template_type:"generic",elements:[{title:function(e,n,t,o){switch(t){case u.BORROWED:return e+" pożyczył"+v(n)+" od ciebie "+o+" zł";case u.LENT:return e+" pożyczył"+v(n)+" ci "+o+" zł";case u.BORROWED_PAYOFF:return e+" oddał"+v(n)+" ci "+o+" zł";case u.LENT_PAYOFF:return e+" otrzymał"+v(n)+" od ciebie "+o+" zł"}}(e,n,o,a),subtitle:(r=o,r===u.BORROWED_PAYOFF||r===u.LENT_PAYOFF?"Akceptuj aby zapisać spłatę":"Akceptuj dług aby otrzymać przypomnienie."),image_url:s.homeUrl+"assets/logo.png",default_action:{type:"web_url",url:s.homeUrl+"#/acceptDebt/"+t,messenger_extensions:!0,webview_height_ratio:"compact"},buttons:[{type:"web_url",url:s.homeUrl+"#/acceptDebt/"+t,title:"Akceptuj",messenger_extensions:!0,webview_height_ratio:"compact"}]}]}}};return d(i,"current_thread").then(function(e){return e.is_sent})}var _=t("//Fk"),h=t.n(_),y=t("mvHQ"),g=t.n(y);function P(e){return new h.a(function(n,t){return 200!==e.status?500===e.status?e.json().then(function(n){var o="";return n&&(o=n.error),t(new Error("HTTP error "+e.status+": "+o))}):t(new Error("HTTP error "+e.status)):n(e.json())})}function b(){return m().then(function(e){return e.permissions&&e.permissions.includes("user_profile")?h.a.resolve():f("user_profile")})}var R={name:"AddDebt",data:function(){var e=this;return{amount:10,debtTypes:u,isPayoffRadioValue:"0",isBorrowedRadioValue:"0",isPayoff:function(){return"0"!==e.isPayoffRadioValue},isBorrowed:function(){return"0"!==e.isBorrowedRadioValue},add:function(){var n,t,o=(n=e.isPayoff(),t=e.isBorrowed(),n?t?u.BORROWED_PAYOFF:u.LENT_PAYOFF:t?u.BORROWED:u.LENT);b().then(function(e){return p(s.fbAppId)}).then(function(n){return t=n.psid,a=n.tid,r=o,i=e.amount,fetch(s.apiUrl+"/debts/add",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:g()({psid:t,threadId:a,debtType:r,amount:i})}).then(P);var t,a,r,i}).then(function(n){return w(n.userName,n.userGender,n.debtId,o,e.amount)}).then(function(e){return e?l():null}).catch(alert)}}}},E={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"adding-panel"},[t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isPayoffRadioValue,expression:"isPayoffRadioValue"}],attrs:{type:"radio",value:"0",name:"isPayoff"},domProps:{checked:e._q(e.isPayoffRadioValue,"0")},on:{change:function(n){e.isPayoffRadioValue="0"}}}),e._v(" Pożyczka\n          "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.isPayoffRadioValue,expression:"isPayoffRadioValue"}],attrs:{type:"radio",value:"1",name:"isPayoff"},domProps:{checked:e._q(e.isPayoffRadioValue,"1")},on:{change:function(n){e.isPayoffRadioValue="1"}}}),e._v(" Spłata\n      ")]),e._v(" "),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isBorrowedRadioValue,expression:"isBorrowedRadioValue"}],attrs:{type:"radio",value:"0",name:"isBorrowed"},domProps:{checked:e._q(e.isBorrowedRadioValue,"0")},on:{change:function(n){e.isBorrowedRadioValue="0"}}}),e._v(" "),e.isPayoff()?t("span",[e._v(" Ktoś mi oddaje")]):t("span",[e._v(" Pożyczam komuś")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.isBorrowedRadioValue,expression:"isBorrowedRadioValue"}],attrs:{type:"radio",value:"1",name:"isBorrowed"},domProps:{checked:e._q(e.isBorrowedRadioValue,"1")},on:{change:function(n){e.isBorrowedRadioValue="1"}}}),e._v(" "),e.isPayoff()?t("span",[e._v(" Oddaję komuś")]):t("span",[e._v(" Pożyczam od kogoś")])]),e._v(" "),t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.amount,expression:"amount"}],attrs:{type:"number",id:"amount"},domProps:{value:e.amount},on:{input:function(n){n.target.composing||(e.amount=n.target.value)}}})]),e._v(" "),t("div",[t("button",{on:{click:function(n){e.add()}}},[e._v("Send")])])])},staticRenderFns:[]};var O={name:"MainPage",components:{"add-debt":t("VU/8")(R,E,!1,function(e){t("b/Fu")},"data-v-88c7eb70",null).exports},data:function(){return{}}},B={render:function(){var e=this.$createElement;return(this._self._c||e)("add-debt")},staticRenderFns:[]},F=t("VU/8")(O,B,!1,null,null,null).exports,A={name:"AddDebt",data:function(){return{message:"Ładowanie...",close:function(){l()}}},created:function(){var e=this;b().then(function(e){return p(s.fbAppId)}).then(function(n){return t=n.psid,o=e.$route.params.id,fetch(s.apiUrl+"/debts/accept/"+o,{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:g()({psid:t})}).then(P);var t,o}).then(function(n){n.debt.user2?e.message="Dług został zapisany":e.message="Dług nie został jeszcze zaakceptoawny"}).catch(alert)}},V={render:function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"adding-panel"},[t("p",[e._v(e._s(e.message))]),e._v(" "),t("button",{on:{click:function(n){e.close()}}},[e._v("Ok")])])},staticRenderFns:[]};var k=t("VU/8")(A,V,!1,function(e){t("Ze1p")},"data-v-9b3680d2",null).exports;o.a.use(i.a);var x=new i.a({routes:[{path:"/",name:"HelloWorld",component:F},{path:"/acceptDebt/:id",name:"AcceptDebt",component:k}]});o.a.config.productionTip=!1;var T=!1;!function(e,n,t){var o,a=e.getElementsByTagName("script")[0];e.getElementById("Messenger")||((o=e.createElement("script")).id="Messenger",o.src="//connect.facebook.com/en_US/messenger.Extensions.js",a.parentNode.insertBefore(o,a))}(document),window.extAsyncInit=function(){T||z()};function z(){new o.a({el:"#app",router:x,template:"<App/>",components:{App:r}})}},Ze1p:function(e,n){},aTrT:function(e,n){},"b/Fu":function(e,n){}},["NHnr"]);
//# sourceMappingURL=app.0a6f93e464b1066e5734.js.map